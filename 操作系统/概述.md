# [概述]

操作系统的特征

1.并发（Concurrence)

​	两个或多个事件在同一时间间隔内发生，引入进程的目的是使程序能够并发执行。

​	单处理机环境下，并发其实是短时间内交替进行，通过分时实现。

2.共享（Sharing）

​	系统资源可被并发执行的进程共同使用，可分为

​		（1）互斥共享

​				如打印机，只允许一个进程访问完并释放资源后，才可被另一进程使用。

​		（2）同时共享

​				允许在一段时间内多个进程对这类资源进行访问。

3.虚拟（Virtual）

​	将物理实体变为若干逻辑对应物体。

​	时（时间）分复用技术：如并发处理时每个进程轮流占用处理器，执行一个时间片并切换。

​	空（空间）分复用技术：虚拟内存。

4.异步（Asynchronism）

​	进程的执行不是一次执行完，而是断断续续的。



基本功能

​	1.进程管理

​	2.内存管理

​	3.文件管理

​	4.设备管理



操作系统的运行机制

​	计算机系统中，通常CPU执行两种不同性质的程序：一种是操作系统内核程序，一种是用户自编程程序或系统外层应用程序。



内核程序是系统外层应用程序的管理者。

操作系统在具体实现上划分了用户态（目态）和和心态（管态）以严格区分两类程序。



大多数操作系统内核包含四个方面内容：

1.时钟管理

​	时钟除了计时之外，可以通过时钟中断的管理，实现进程的转换。如在分时操作系统中，采用时间片轮转调度；在实时系统中，按截止时间控制运行...

2.中断机制

键鼠信息输入、进程的管理调度、系统功能的调用、设备驱动、文件访问等都依赖于中断。

中断机制中，只有一小部分属于内核，负责保护和恢复中断现场的信息，转移控制权到相关处理程序，以减少中断的处理时间，提高系统的并行处理能力。

​	①外中断

​	由CPU执行指令以外的事件引起，如I/O完成中断。

​	②异常

​	又称内中断、例外或陷入。由CPU执行指令的内部事件引起，如非法操作码，地址越界，算术溢出。对异常的处理一般要依赖于当前程序的运行现场，且异常不能被屏蔽，一旦出现应立即处理。



"CPU执行完一条指令之后，下一条指令开始之前响应中断，而在一条指令执行中也可以响应陷阱。例如执行指令非法时，尽管被执行的非法指令不能执行结束，但CPU仍可对其进行处理。"

by https://blog.csdn.net/frozenshore/article/details/48738207



​	③陷入（trap）

​	在用户程序中使用系统调用



3.原语

​	Atomic Operation ，处于操作系统最底层，原子性，运行时间较短且调用频繁的程序。定义原语最直接的方法时把中断关闭待其执行完再打开中断。



4.系统控制的数据结构及处理

​	①进程管理：

​	由CPU执行指令以外的事件引起，如I/O完成中断。

​	②存储器管理：存储器的空间分配和回收，内存信息保护程序等

​	③设备管理：缓冲区管理，设备分配和回收等





系统调用

​	如果一个进程在用户态需要使用内核态的功能，就进行系统调用陷入内核，由操作系统代为完成。

这些系统调用按功能大致可分为：

​	1.设备管理

​	2.文件管理

​	3.进程控制

​	4.进程通信

​	5.内存管理





![img](https://github.com/CyC2018/CS-Notes/raw/master/notes/pics/tGPV0.png)

Linux 的系统调用主要有以下这些：

| Task     | Commands                    |
| -------- | --------------------------- |
| 进程控制 | fork(); exit(); wait();     |
| 进程通信 | pipe(); shmget(); mmap();   |
| 文件操作 | open(); read(); write();    |
| 设备操作 | ioctl(); read(); write();   |
| 信息维护 | getpid(); alarm(); sleep(); |
| 安全     | chmod(); umask(); chown();  |

by 

[https://github.com/CyC2018/CS-Notes/blob/master/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20-%20%E6%A6%82%E8%BF%B0.md](https://github.com/CyC2018/CS-Notes/blob/master/notes/计算机操作系统 - 概述.md)





操作系统的体系结构

​	大内核和微内核

​		大内核是将操作系统功能作为一个紧密结合的整体放到内核，因为各模块共享信息，能有效利用相互间的有效特性，性能很高。

​		为了解决操作系统内核代码难以维护的问题，提出了微内核的体系结构，将基本的功能（如进程管理）留在内核，其他的转到用户态执行。移出内核的代码被分成相互独立的服务程序。微内核最大的问题是性能问题，因为需要不断在核心态和用户态间切换。





死锁：

原因：1.互斥调剂；2.请求和保持条件：请求资源阻塞时，对已获得资源保持不放；3.已获得资源使用完之前不能被剥夺，只能由自己释放4.环路等待



预防：

破坏请求条件：资源一次性分配；

破坏保持条件：只要有一个资源得不到分配，也不给它分配其他资源

破坏不可剥夺条件：当某进程获得了部分资源，但得不到其他资源，则释放已有的资源

破坏环路等待条件：资源有序分配法，系统给每类资源赋予一个编号，每一个进程按编号递增的顺序请求资源，释放则相反



1、以确定的顺序获得锁

2、超时放弃



避免死锁：

预防死锁的策略，会严重损害系统性能。因此避免死锁时要施加较弱的限制，从而获得较满意的系统性能。代表性算法：银行家算法。



检测死锁：

1.首先为每个进程和每个资源指定唯一的号码。

2.然后建立资源分配表和进程等待表



解除死锁：

1.剥夺资源：从其他进程剥夺足够数量的资源给死锁进程，以解除死锁状态

2.撤销进程：直接撤销死锁进程或撤销代价最小的进程，直至有足够资源可用





